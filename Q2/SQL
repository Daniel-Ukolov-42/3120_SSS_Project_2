import sqlite3

# Connect to SQLite database 
conn = sqlite3.connect('athlete_heights.db')
cursor = conn.cursor()

# Create tables
cursor.execute('''
    CREATE TABLE IF NOT EXISTS mens_swimming (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        height REAL NOT NULL
    )
''')

cursor.execute('''
    CREATE TABLE IF NOT EXISTS mens_volleyball (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        height REAL NOT NULL
    )
''')

cursor.execute('''
    CREATE TABLE IF NOT EXISTS womens_swimming (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        height REAL NOT NULL
    )
''')

cursor.execute('''
    CREATE TABLE IF NOT EXISTS womens_volleyball (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        height REAL NOT NULL
    )
''')

conn.commit()

# Insert data into each table
for _, row in mens_swim_df.iterrows():
    cursor.execute("INSERT INTO mens_swimming (name, height) VALUES (?, ?)", (row['Name'], row['Height']))

for _, row in mens_volley_df.iterrows():
    cursor.execute("INSERT INTO mens_volleyball (name, height) VALUES (?, ?)", (row['Name'], row['Height']))

for _, row in womens_swim_df.iterrows():
    cursor.execute("INSERT INTO womens_swimming (name, height) VALUES (?, ?)", (row['Name'], row['Height']))

for _, row in womens_volley_df.iterrows():
    cursor.execute("INSERT INTO womens_volleyball (name, height) VALUES (?, ?)", (row['Name'], row['Height']))

# Commit the inserts
conn.commit()


#Add 'teams' column to df
tables = {
    'mens_swimming': 'Men\'s Swimming',
    'mens_volleyball': 'Men\'s Volleyball',
    'womens_swimming': 'Women\'s Swimming',
    'womens_volleyball': 'Women\'s Volleyball'
}

# Create a list to store dataframes
dfs = []

# Loop through each table and read data, adding a 'Team' column
for table_name, team_label in tables.items():
    df = pd.read_sql_query(f"SELECT * FROM {table_name}", conn)
    df['Team'] = team_label  # Add team name as a new column
    dfs.append(df)

# Concatenate all dataframes into one
combined_df = pd.concat(dfs, ignore_index=True)

# Save to CSV
combined_df.to_csv('all_athletes_combined.csv', index=False)

# Close the database connection
conn.close()


